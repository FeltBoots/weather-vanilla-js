"use strict";var _createClass=function(){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}}();function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}window.addEventListener("load",function(){var a=document.querySelector(".weather-js");if(a){var r=function(){function n(){_classCallCheck(this,n)}return _createClass(n,null,[{key:"appendNodes",value:function(t){for(var e=arguments.length,i=Array(1<e?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];i.forEach(function(e){t.appendChild(e)})}},{key:"attachIconNode",value:function(e,t,i){this.iconCanvas=document.createElement("canvas"),this.iconCanvas.setAttribute("class","icon"),this.iconCanvas.setAttribute("id","icon1"),this.iconCanvas.setAttribute("width",t),this.iconCanvas.setAttribute("height",i),n.appendNodes(e,this.iconCanvas)}},{key:"setIcon",value:function(e,t){var i=arguments.length<=2||void 0===arguments[2]?"white":arguments[2],n=new Skycons({color:i}),a=e.replace(/-/g,"_").toUpperCase();n.play(),n.set(t,Skycons[a])}},{key:"getPercentage",value:function(e){return Math.round(100*e)}},{key:"getWeekDay",value:function(e,t){return moment(1e3*e).tz(t).format("ddd")}},{key:"getTimeStamp",value:function(e,t){return moment(e).tz(t).format("h:mm A")}},{key:"getDate",value:function(e,t){return moment(1e3*e).tz(t).format("dddd, MMMM Do")}}]),n}(),t=function(){function o(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1];_classCallCheck(this,o),t&&(this.createCardNode(e),this.atachEventOnTemperature())}return _createClass(o,[{key:"createCardNode",value:function(e){this.temperatureSection=e,this.row=document.createElement("div"),this.row.classList.add("row"),this.dayNode=document.createElement("h2"),this.dayNode.classList.add("week-day"),this.degreeSectionNode=document.createElement("div"),this.degreeSectionNode.classList.add("degree-section"),this.tempDayNode=document.createElement("h2"),this.tempDayNode.classList.add("temperature-degree-day"),this.tempNightNode=document.createElement("h2"),this.tempNightNode.classList.add("temperature-degree-night"),r.appendNodes(this.degreeSectionNode,this.tempDayNode,this.tempNightNode),r.attachIconNode.call(this,this.row,64,64),r.appendNodes(this.row,this.dayNode),r.appendNodes(this.row,this.degreeSectionNode),r.appendNodes(e,this.row)}},{key:"animateIn",value:function(){this.temperatureSection.classList.remove("visibility-false"),this.temperatureSection.classList.add("visibility-true"),this.row.classList.add("agent-2"),this.tempNightNode.classList.add("deg-far"),this.tempDayNode.classList.add("deg-far")}},{key:"animateOut",value:function(){this.temperatureSection.classList.remove("visibility-true"),this.temperatureSection.classList.add("visibility-false"),this.row.classList.remove("agent-2"),this.tempNightNode.classList.remove("deg-far"),this.tempDayNode.classList.remove("deg-far")}},{key:"atachEventOnTemperature",value:function(){var n=this;this.degreeSectionNode.addEventListener("click",function(){console.log("click");var e=n.tempDayNode,t=n.tempNightNode;if(e.classList.contains("deg-far")){e.classList.remove("deg-far"),t.classList.remove("deg-far"),e.classList.add("deg-cel"),t.classList.add("deg-cel");var i=function(e){return 5/9*(e-32)};n.tempDay=i(n.tempDay),n.tempNight=i(n.tempNight)}else console.log("netu"),e.classList.remove("deg-cel"),t.classList.remove("deg-cel"),e.classList.add("deg-far"),t.classList.add("deg-far"),n.tempDay=n.fixTempDay,n.tempNight=n.fixTempNight})}},{key:"tempDay",get:function(){return this.tempDayNode.textContent},set:function(e){this.tempDayNode.textContent=Math.round(e)}},{key:"tempNight",get:function(){return this.tempNightNode.textContent},set:function(e){this.tempNightNode.textContent=Math.round(e)}},{key:"dayName",get:function(){return this.dayNode.textContent},set:function(e){this.dayNode.textContent=e}},{key:"description",set:function(e){this.tempDescriptionNode.textContent=e}}],[{key:"create",value:function(e,t){var i=document.createElement("div");i.classList.add("temperature-section","visibility-false");for(var n=[],a=0;a<t;a++)n.push(new o(i));return r.appendNodes(e,i),n}}]),o}(),i=function(e){function i(e){_classCallCheck(this,i);var t=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,null,!1));return t.createCardNode(e),t.atachEventOnTemperature(),t.timezone="",t}return _inherits(i,t),_createClass(i,[{key:"createCardNode",value:function(e){this.timezoneDescriptionNode=document.createElement("div"),this.timezoneDescriptionNode.classList.add("timezone-description"),this.locationNode=document.createElement("h1"),this.locationNode.classList.add("location-timezone"),this.dayNode=document.createElement("h2"),this.dayTemperature=document.createElement("h3"),this.weatherDescription=document.createElement("h4"),r.appendNodes(this.timezoneDescriptionNode,this.locationNode,this.dayNode,this.dayTemperature,this.weatherDescription),this.dayDescriptionNode=document.createElement("div"),this.dayDescriptionNode.classList.add("day-description");var t=document.createElement("ul");t.classList.add("desc-first");var i=document.createElement("ul");i.classList.add("desc-second"),this.precipitationNode=document.createElement("li"),this.humidityNode=document.createElement("li"),this.windNode=document.createElement("li"),this.cloudCoverageNode=document.createElement("li"),this.sunriseNode=document.createElement("li"),this.dewPointNode=document.createElement("li"),this.visibilityNode=document.createElement("li"),this.sunsetNode=document.createElement("li"),r.appendNodes(t,this.sunriseNode,this.precipitationNode,this.humidityNode,this.windNode),r.appendNodes(i,this.sunsetNode,this.cloudCoverageNode,this.dewPointNode,this.visibilityNode),r.appendNodes(this.dayDescriptionNode,t,i),this.locationSection=document.createElement("div"),this.locationSection.classList.add("location-section","visibility-false"),r.appendNodes(this.locationSection,this.timezoneDescriptionNode),r.attachIconNode.call(this,this.locationSection,128,128),r.appendNodes(this.locationSection,this.dayDescriptionNode),r.appendNodes(e,this.locationSection)}},{key:"atachEventOnTemperature",value:function(){var e=this,t=this.dayTemperature;t.addEventListener("click",function(){t.classList.contains("deg-far")?(t.classList.remove("deg-far"),t.classList.add("deg-cel"),e.temperature=(e.temperatureFer-32)*(5/9)):(t.classList.remove("deg-cel"),t.classList.add("deg-far"),e.temperature=e.temperatureFer)})}},{key:"animateIn",value:function(){this.locationSection.classList.remove("visibility-false"),this.locationSection.classList.add("visibility-true"),this.timezoneDescriptionNode.classList.add("agent-1"),this.iconCanvas.classList.add("agent-3"),this.dayDescriptionNode.classList.add("agent-2"),this.dayTemperature.classList.add("deg-far")}},{key:"animateOut",value:function(){this.locationSection.classList.remove("visibility-true"),this.locationSection.classList.add("visibility-false"),this.timezoneDescriptionNode.classList.remove("agent-1"),this.iconCanvas.classList.remove("agent-3"),this.dayDescriptionNode.classList.remove("agent-2"),this.dayTemperature.classList.remove("deg-far")}},{key:"cityLocation",get:function(){return this.locationNode.textContent},set:function(e){this.locationNode.textContent=e}},{key:"precipitation",set:function(e){this.precipitationNode.innerHTML="Precipitation: <span>"+r.getPercentage(e)+"%</span>"}},{key:"humidity",set:function(e){this.humidityNode.innerHTML="Humidity: <span>"+r.getPercentage(e)+"%</span>"}},{key:"wind",set:function(e){this.windNode.innerHTML="Wind: <span>"+e+" mph</span>"}},{key:"sunrise",set:function(e){var t=r.getTimeStamp(1e3*e,this.timezone);this.sunsetNode.innerHTML="Sunset: <span>"+t+"</span>"}},{key:"sunset",set:function(e){var t=r.getTimeStamp(1e3*e,this.timezone);this.sunriseNode.innerHTML="Sunrise: <span>"+t+"</span>"}},{key:"cloudCoverage",set:function(e){this.dewPointNode.innerHTML="Cloud Coverage: <span>"+r.getPercentage(e)+"%</span>"}},{key:"dewPoint",set:function(e){this.cloudCoverageNode.innerHTML="Dew Point: <span>"+Math.round(e)+"Â° F</span>"}},{key:"visibility",set:function(e){this.visibilityNode.innerHTML="Visibility: <span>"+Math.round(e)+" miles</span>"}},{key:"description",set:function(e){this.weatherDescription.textContent=e}},{key:"temperature",set:function(e){this.dayTemperature.textContent=Math.round(e)}}],[{key:"create",value:function(){return new i(a)}}]),i}(),n=function(){function n(e,t){_classCallCheck(this,n),this.time=e.time,this.zone=t}return _createClass(n,[{key:"fullDay",get:function(){return r.getDate(this.time,this.zone)}},{key:"weekDay",get:function(){return r.getWeekDay(this.time,this.zone)}}],[{key:"createDays",value:function(e,t){var i=[];return e.forEach(function(e){i.push(new n(e,t))}),i}}]),n}(),o=function(){function t(e){_classCallCheck(this,t),this.createCardNode(e)}return _createClass(t,[{key:"createCardNode",value:function(e){var t=document.createElement("div");t.classList.add("input-section"),this.inputContainerNode=document.createElement("input-wrapper"),this.inputContainerNode.classList.add("input-container","input-borders"),this.inputSearchNode=document.createElement("input"),this.inputSearchNode.setAttribute("type","search"),this.inputSearchNode.setAttribute("placeholder","Enter the name of the city"),this.inputSearchNode.classList.add("search-input","input-borders"),this.inputSubmitNode=document.createElement("input"),this.inputSubmitNode.setAttribute("type","submit"),this.inputSubmitNode.setAttribute("value","Search"),r.appendNodes(this.inputContainerNode,this.inputSearchNode),r.appendNodes(t,this.inputContainerNode),r.appendNodes(e,t)}}],[{key:"create",value:function(){return new t(a)}}]),t}(),s=function(){function e(){_classCallCheck(this,e),this.input=o.create(a),this.description=i.create(a),this.week=t.create(a,8),this.days=[],this.address=""}return _createClass(e,[{key:"fillToday",value:function(e){var t=this.description;t.cityLocation=this.description.cityLocation,t.timezone=this.timezone,t.dayName=this.days[0].fullDay,t.precipitation=e.precipProbability,t.sunrise=e.sunriseTime,t.humidity=e.humidity,t.wind=e.windSpeed,t.sunset=e.sunsetTime,t.cloudCoverage=e.cloudCover,t.dewPoint=e.dewPoint,t.visibility=e.visibility,t.description=e.summary,t.temperature=Math.round(e.temperatureMax),t.temperatureFer=Math.round(e.temperatureMax),t.dayTemperature.classList.contains("deg-cel")&&(t.dayTemperature.classList.remove("deg-cel"),t.dayTemperature.classList.add("deg-far"));var i=e.icon;r.setIcon(i,t.iconCanvas),t.animateIn()}},{key:"fillWeek",value:function(e){var s=this;e.forEach(function(e,t){var i=e.temperatureMax,n=e.temperatureMin,a=e.icon,o=(e.summary,s.week[t]);o.dayName=s.days[t].weekDay,r.setIcon(a,o.iconCanvas),o.tempDay=i,o.tempNight=n,o.fixTempDay=i,o.fixTempNight=n,o.dayNode.addEventListener("click",function(){s.fillToday(e)}),o.animateIn()})}},{key:"fillContent",value:function(e){var t=e.daily.data;this.timezone=e.timezone,this.days=n.createDays(t,this.timezone),this.fillToday(t[0]),this.fillWeek(t)}},{key:"updateCity",value:function(e){this.description.cityLocation=e}},{key:"animateOut",value:function(){this.description.animateOut(),this.week.forEach(function(e){e.animateOut()})}}]),e}(),c=function(e){function o(){var e;_classCallCheck(this,o);for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var a=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(i)));return Error.captureStackTrace(a,o),a}return _inherits(o,Error),o}(),d=function(e){function o(){var e;_classCallCheck(this,o);for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var a=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(i)));return Error.captureStackTrace(a,c),a}return _inherits(o,Error),o}(),u=function(e){function o(){var e;_classCallCheck(this,o);for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var a=_possibleConstructorReturn(this,(e=o.__proto__||Object.getPrototypeOf(o)).call.apply(e,[this].concat(i)));return Error.captureStackTrace(a,c),a}return _inherits(o,Error),o}();(function(){function e(){_classCallCheck(this,e),this.manager=new s,this.createScrollTop(),this.googleMapAPIKey="AIzaSyDoYhVFl3m0T8SLmWdFxHZDOLiw7nMvg_M",this.darkSkyAPIKey="30babca7ccb92efe1f4309d7f1a58a79",this.proxy="https://cors-anywhere.herokuapp.com/",this.initInputAutocomplite(),this.getCurrentWeather()}return _createClass(e,[{key:"updateApiDarkSky",value:function(e){this.apiDarkSky=this.proxy+"https://api.darksky.net/forecast/"+this.darkSkyAPIKey+"/"+e.lat+","+e.lng}},{key:"updateApiGoogleMaps",value:function(e){this.apiGoogleMaps="https://maps.googleapis.com/maps/api/geocode/json?address="+e+"&key="+this.googleMapAPIKey}},{key:"updateAddress",value:function(e){this.manager.updateCity(e)}},{key:"showError",value:function(e){this.errorMessage||(this.errorMessage=document.createElement("div"),this.errorMessage.classList.add("isa-error"),a.appendChild(this.errorMessage)),this.errorMessage.textContent=e.message+"\nPlease contact to developers in description below and have a nice day :)"}},{key:"makeRequest",value:function(){var t=this;fetch(this.apiGoogleMaps).then(function(e){if(e.ok)return e.json();throw new c("Sorry, it seems like Google Maps do not response.")}).then(function(e){if(!e)throw new d("Sorry, it seems like data from Google Maps is not available.");return t.updateApiDarkSky(e.results[0].geometry.location),t.currentAddress=e.results[0].address_components[0].long_name,fetch(t.apiDarkSky)}).then(function(e){if(e.ok)return e.json();throw new c("Sorry, it seems like DarkSky do not response.")}).then(function(e){if(!e)throw new d("Sorry, it seems like data from DarkSky is not available.");try{t.manager.fillContent(e),t.updateAddress(t.currentAddress)}catch(e){throw new u("Sorry, it seems like some internal error happened.")}}).catch(function(e){t.showError(e)})}},{key:"initInputAutocomplite",value:function(){var t=this,e=document.querySelector(".search-input");this.autocomplite=new google.maps.places.Autocomplete(e),this.autocomplite.addListener("place_changed",function(){t.manager.animateOut();var e=t.autocomplite.getPlace();t.updateApiGoogleMaps(e.formatted_address),t.makeRequest()}),document.querySelector(".input-container").addEventListener("submit",function(e){e.preventDefault()})}},{key:"getCurrentWeather",value:function(){var n=this;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var t=e.coords.longitude,i=e.coords.latitude;n.updateApiDarkSky({lat:i,lng:t}),fetch(n.apiDarkSky).then(function(e){if(e.ok)return e.json();throw new c("Sorry, it seems like DarkSky do not response.")}).then(function(e){if(!e)throw new d("Sorry, it seems like data from DarkSky is not available.");try{n.manager.fillContent(e),n.updateAddress(e.timezone)}catch(e){throw new u("Sorry, it seems like some internal error happened.")}}).catch(function(e){n.showError(e)})})}},{key:"createScrollTop",value:function(){var e=document.createElement("div");e.classList.add("scroll");var t=document.createElement("a");t.classList.add("arrow","arrow-up"),r.appendNodes(e,t),r.appendNodes(a,e);var i=0,n=function(){0===window.pageYOffset&&(clearInterval(i),document.body.scrollTop=0),window.scroll(0,window.pageYOffset-50)};t.addEventListener("click",function(){i=setInterval(n,15)});window.onscroll=function(){20<document.body.scrollTop||document.documentElement.scrollTop?document.querySelector(".scroll").style.display="block":document.querySelector(".scroll").style.display="none"}}}],[{key:"create",value:function(){new e}}]),e})().create()}});